<div class="container-fluid --bs-white">
  <div class="row">
    <div class="col">
      <button mat-icon-button [routerLink]="['/question_bank']">
        <mat-icon>arrow_back</mat-icon>
      </button>
    </div>

    <div class="col p-2 d-flex justify-content-end">

      <button *ngIf="!excelJsonData" mat-raised-button color="primary" (click)="uploadExel.click()">
        <mat-icon>grid_on</mat-icon>
        Upload Excel
      </button>
      <button *ngIf="excelJsonData" mat-raised-button color="primary" (click)="cancelExcelFileData()">
        <mat-icon>close</mat-icon>
        Cancel Excel
      </button>
      <input #uploadExel class="d-none" type="file" (change)="readExcelData($event)" accept=".xlsx, .xls">

    </div>
  </div>

</div>
<ng-container *ngIf="excelJsonData">
  <h2>hi excel data here</h2>
  <div class="table-container">
    <table mat-table class="full-width-table m-1" aria-label="Elements" [dataSource]="excelJsonData">


      <ng-container matColumnDef="question">
        <th mat-header-cell *matHeaderCellDef>Question</th>
        <td mat-cell  *matCellDef="let row; let i = index">{{row.question}}</td>
      </ng-container>
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>Serial</th>
        <td mat-cell  *matCellDef="let row; let i = index">{{row.question}}</td>
      </ng-container>



      <!-- Name Column -->
      <ng-container matColumnDef="subject">
        <th mat-header-cell *matHeaderCellDef>Subject</th>
        <td mat-cell *matCellDef="let row; let i = index" >{{row.subject}}</td>
      </ng-container>

      <ng-container matColumnDef="chapter">
        <th mat-header-cell *matHeaderCellDef>Chapter</th>
        <td mat-cell *matCellDef="let row;let i = index" >{{row.chapter}}</td>
      </ng-container>


      <ng-container matColumnDef="option_text_1">
        <th mat-header-cell *matHeaderCellDef>Option 1</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.option_text_1}}</td>
      </ng-container>

      <ng-container matColumnDef="option_text_2">
        <th mat-header-cell *matHeaderCellDef>Option 2</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.option_text_2}}</td>
      </ng-container>


      <ng-container matColumnDef="option_text_3">
        <th mat-header-cell *matHeaderCellDef>Option 3</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.option_text_3}}</td>
      </ng-container>


      <ng-container matColumnDef="option_text_4">
        <th mat-header-cell *matHeaderCellDef>Option 4</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.option_text_4}}</td>
      </ng-container>

      <ng-container matColumnDef="correct_ans">
        <th mat-header-cell *matHeaderCellDef>Correct Option</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.correct_ans}}</td>
      </ng-container>

      <ng-container matColumnDef="explanation">
        <th mat-header-cell *matHeaderCellDef>Explanation</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.explanation}}</td>
      </ng-container>
      <ng-container matColumnDef="categories">
        <th mat-header-cell *matHeaderCellDef>Categories</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.categories}}</td>
      </ng-container>
      <ng-container matColumnDef="hardness">
        <th mat-header-cell *matHeaderCellDef>Hardness</th>
        <td mat-cell *matCellDef="let row;let i = index">{{row.hardness}}</td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>


  </div>
</ng-container>

<div class="container-fluid">
  <form [formGroup]="questionBankAddForm" (ngSubmit)="onSubmit()" class="form">


    <div class="row">

      <div class="col-12 col-sm-6 col-md-4">
        <mat-form-field class="full-width">
          <mat-label>varsity</mat-label>
          <mat-select formControlName="varsity">
            <mat-option *ngFor="let label of varsity_enum_dict|keyvalue" [value]=label.key>{{ label.value   }} </mat-option>

          </mat-select>
          <mat-error *ngIf="questionBankAddForm.controls.varsity.invalid">
            <span *ngIf="questionBankAddForm.controls.varsity.errors?.['required']">Varsity is required.</span>
          </mat-error>
        </mat-form-field>
        <span *ngIf="questionBankAddForm.controls.varsity.errors">{{questionBankAddForm.controls.varsity.errors['api_error'] }}</span>
      </div>


      <div class="col-12 col-sm-6 col-md-4">
        <mat-form-field class="full-width">
          <mat-label>Unit</mat-label>
          <mat-select formControlName="unit">
            <mat-option *ngFor="let label of varsity_unit_enum_dict|keyvalue" [value]=label.key>{{ label.value   }} </mat-option>

          </mat-select>
          <mat-error *ngIf="questionBankAddForm.controls.unit.invalid">
            <span *ngIf="questionBankAddForm.controls.unit.errors?.['required']">Unit is required.</span>
          </mat-error>
        </mat-form-field>
        <span *ngIf="questionBankAddForm.controls.unit.errors">{{questionBankAddForm.controls.unit.errors['api_error'] }}</span>
      </div>

      <div class="col-12 col-sm-6 col-md-4">
        <mat-form-field class="full-width">
          <mat-label>Year</mat-label>
          <input matInput type="text" formControlName="year">
          <mat-error *ngIf="questionBankAddForm.controls.year.invalid">
            <span *ngIf="questionBankAddForm.controls.year.errors?.['required']">Year is required.</span>
          </mat-error>
        </mat-form-field>
        <span *ngIf="questionBankAddForm.controls.year.errors">{{questionBankAddForm.controls.year.errors['api_error'] }}</span>

      </div>


    </div>

    <div class="row mb-5  mt-4">
      <div class="col d-flex justify-content-center">
        <button  class="ps-5 pe-5" mat-raised-button color="primary" type="submit">Submit</button>
      </div>
    </div>


  </form>
</div>
